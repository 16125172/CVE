# download kernel and build

git clone https://github.com/torvalds/linux
git checkout 4c48abe91be03d191d0c20cc755877da2cb35622^
make defconfig
make -j 4

# download busybox and build in static
make defconfig -j LDFLAGS=-static
make LDFLAGS=-static -j 4 install

# prepare le fs
cd _install

mkdir -p etc/init.d
echo 'for i in $(seq 1 9); do mknod /dev/tty$i c 4 1; done' > etc/init.d/rcS
chmod +x etc/init.d/rcS

cd _install && find . | cpio -o --format=newc --owner=root:root > ../rootfs.img

qemu-system-x86_64 -kernel bzImage -initrd rootfs.img -append "root=/dev/ram rdinit=/sbin/init console=ttyS0" -nographic -serial stdio -monitor /dev/null

# tty ... put it in /etc/init.d/rcS
for i in $(seq 1 9); do mknod /dev/tty$i c 4 1; done

